{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bartc\\\\Documents\\\\Github\\\\DAML-Covid19\\\\ui-js\\\\src\\\\components\\\\App.js\";\nimport React, { useEffect } from \"react\";\nimport { HashRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport Layout from \"./Layout/Layout\";\nimport Error from \"../pages/error/Error\";\nimport Login from \"../pages/login/Login\";\nimport { useUserState, useUserDispatch } from \"../context/UserContext\";\nexport default function App() {\n  const userState = useUserState();\n  return /*#__PURE__*/React.createElement(HashRouter, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    component: RootRoute,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/app\",\n    render: () => /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/app/report\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 18,\n        columnNumber: 25\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    path: \"/app\",\n    component: Layout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(PublicRoute, {\n    path: \"/login\",\n    component: Login,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    component: Error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 9\n    }\n  }))); // #######################################################################\n\n  function RootRoute(props) {\n    var userDispatch = useUserDispatch();\n    useEffect(() => {\n      const url = new URL(window.location.toString());\n      const token = url.searchParams.get('token');\n\n      if (token === null) {\n        return;\n      }\n\n      const party = url.searchParams.get('party');\n\n      if (party === null) {\n        throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");\n      }\n\n      localStorage.setItem(\"daml.party\", party);\n      localStorage.setItem(\"daml.token\", token);\n      userDispatch({\n        type: \"LOGIN_SUCCESS\",\n        token,\n        party\n      });\n    });\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/app/report\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 7\n      }\n    });\n  }\n\n  function PrivateRoute({\n    component,\n    ...rest\n  }) {\n    return /*#__PURE__*/React.createElement(Route, Object.assign({}, rest, {\n      render: props => userState.isAuthenticated ? React.createElement(component, props) : /*#__PURE__*/React.createElement(Redirect, {\n        to: {\n          pathname: \"/login\",\n          state: {\n            from: props.location\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 13\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  function PublicRoute({\n    component,\n    ...rest\n  }) {\n    return /*#__PURE__*/React.createElement(Route, Object.assign({}, rest, {\n      render: props => userState.isAuthenticated ? /*#__PURE__*/React.createElement(Redirect, {\n        to: {\n          pathname: \"/\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }\n      }) : React.createElement(component, props),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 7\n      }\n    }));\n  }\n}","map":{"version":3,"sources":["C:/Users/bartc/Documents/Github/DAML-Covid19/ui-js/src/components/App.js"],"names":["React","useEffect","HashRouter","Route","Switch","Redirect","Layout","Error","Login","useUserState","useUserDispatch","App","userState","RootRoute","props","userDispatch","url","URL","window","location","toString","token","searchParams","get","party","localStorage","setItem","type","PrivateRoute","component","rest","isAuthenticated","createElement","pathname","state","from","PublicRoute"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { HashRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport Layout from \"./Layout/Layout\";\nimport Error from \"../pages/error/Error\";\nimport Login from \"../pages/login/Login\";\nimport { useUserState, useUserDispatch } from \"../context/UserContext\";\n\nexport default function App() {\n  const userState = useUserState();\n\n  return (\n    <HashRouter>\n      <Switch>\n        <Route exact path=\"/\" component={RootRoute} />\n        <Route\n          exact\n          path=\"/app\"\n          render={() => <Redirect to=\"/app/report\" />}\n        />\n        <PrivateRoute path=\"/app\" component={Layout} />\n        <PublicRoute path=\"/login\" component={Login} />\n        <Route component={Error} />\n      </Switch>\n    </HashRouter>\n  );\n\n  // #######################################################################\n\n  function RootRoute(props) {\n    var userDispatch = useUserDispatch();\n\n    useEffect(() => {\n      const url = new URL(window.location.toString());\n      const token = url.searchParams.get('token');\n      if (token === null) {\n        return;\n      }\n      const party = url.searchParams.get('party');\n      if (party === null) {\n        throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");\n      }\n      localStorage.setItem(\"daml.party\", party);\n      localStorage.setItem(\"daml.token\", token);\n\n      userDispatch({ type: \"LOGIN_SUCCESS\", token, party });\n    })\n\n    return (\n      <Redirect to=\"/app/report\" />\n    )\n  }\n\n  function PrivateRoute({ component, ...rest }) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            React.createElement(component, props)\n          ) : (\n            <Redirect\n              to={{\n                pathname: \"/login\",\n                state: {\n                  from: props.location,\n                },\n              }}\n            />\n          )\n        }\n      />\n    );\n  }\n\n  function PublicRoute({ component, ...rest }) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            <Redirect\n              to={{\n                pathname: \"/\",\n              }}\n            />\n          ) : (\n            React.createElement(component, props)\n          )\n        }\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}