{"ast":null,"code":"import _objectWithoutProperties from\"C:\\\\Users\\\\bartc\\\\Documents\\\\Github\\\\DAML-Covid19\\\\ui-js\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";import React,{useEffect}from\"react\";import{HashRouter,Route,Switch,Redirect}from\"react-router-dom\";import Layout from\"./Layout/Layout\";import Error from\"../pages/error/Error\";import Login from\"../pages/login/Login\";import{useUserState,useUserDispatch}from\"../context/UserContext\";export default function App(){var userState=useUserState();return/*#__PURE__*/React.createElement(HashRouter,null,/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",component:RootRoute}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/app\",render:function render(){return/*#__PURE__*/React.createElement(Redirect,{to:\"/app/report\"});}}),/*#__PURE__*/React.createElement(PrivateRoute,{path:\"/app\",component:Layout}),/*#__PURE__*/React.createElement(PublicRoute,{path:\"/login\",component:Login}),/*#__PURE__*/React.createElement(Route,{component:Error})));// #######################################################################\nfunction RootRoute(props){var userDispatch=useUserDispatch();useEffect(function(){var url=new URL(window.location.toString());var token=url.searchParams.get('token');if(token===null){return;}var party=url.searchParams.get('party');if(party===null){throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");}localStorage.setItem(\"daml.party\",party);localStorage.setItem(\"daml.token\",token);userDispatch({type:\"LOGIN_SUCCESS\",token:token,party:party});});return/*#__PURE__*/React.createElement(Redirect,{to:\"/app/report\"});}function PrivateRoute(_ref){var component=_ref.component,rest=_objectWithoutProperties(_ref,[\"component\"]);return/*#__PURE__*/React.createElement(Route,Object.assign({},rest,{render:function render(props){return userState.isAuthenticated?React.createElement(component,props):/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/login\",state:{from:props.location}}});}}));}function PublicRoute(_ref2){var component=_ref2.component,rest=_objectWithoutProperties(_ref2,[\"component\"]);return/*#__PURE__*/React.createElement(Route,Object.assign({},rest,{render:function render(props){return userState.isAuthenticated?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/\"}}):React.createElement(component,props);}}));}}","map":{"version":3,"sources":["C:/Users/bartc/Documents/Github/DAML-Covid19/ui-js/src/components/App.js"],"names":["React","useEffect","HashRouter","Route","Switch","Redirect","Layout","Error","Login","useUserState","useUserDispatch","App","userState","RootRoute","props","userDispatch","url","URL","window","location","toString","token","searchParams","get","party","localStorage","setItem","type","PrivateRoute","component","rest","isAuthenticated","createElement","pathname","state","from","PublicRoute"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { HashRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport Layout from \"./Layout/Layout\";\nimport Error from \"../pages/error/Error\";\nimport Login from \"../pages/login/Login\";\nimport { useUserState, useUserDispatch } from \"../context/UserContext\";\n\nexport default function App() {\n  const userState = useUserState();\n\n  return (\n    <HashRouter>\n      <Switch>\n        <Route exact path=\"/\" component={RootRoute} />\n        <Route\n          exact\n          path=\"/app\"\n          render={() => <Redirect to=\"/app/report\" />}\n        />\n        <PrivateRoute path=\"/app\" component={Layout} />\n        <PublicRoute path=\"/login\" component={Login} />\n        <Route component={Error} />\n      </Switch>\n    </HashRouter>\n  );\n\n  // #######################################################################\n\n  function RootRoute(props) {\n    var userDispatch = useUserDispatch();\n\n    useEffect(() => {\n      const url = new URL(window.location.toString());\n      const token = url.searchParams.get('token');\n      if (token === null) {\n        return;\n      }\n      const party = url.searchParams.get('party');\n      if (party === null) {\n        throw Error(\"When 'token' is passed via URL, 'party' must be passed too.\");\n      }\n      localStorage.setItem(\"daml.party\", party);\n      localStorage.setItem(\"daml.token\", token);\n\n      userDispatch({ type: \"LOGIN_SUCCESS\", token, party });\n    })\n\n    return (\n      <Redirect to=\"/app/report\" />\n    )\n  }\n\n  function PrivateRoute({ component, ...rest }) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            React.createElement(component, props)\n          ) : (\n            <Redirect\n              to={{\n                pathname: \"/login\",\n                state: {\n                  from: props.location,\n                },\n              }}\n            />\n          )\n        }\n      />\n    );\n  }\n\n  function PublicRoute({ component, ...rest }) {\n    return (\n      <Route\n        {...rest}\n        render={props =>\n          userState.isAuthenticated ? (\n            <Redirect\n              to={{\n                pathname: \"/\",\n              }}\n            />\n          ) : (\n            React.createElement(component, props)\n          )\n        }\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}